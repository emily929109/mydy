<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GSAP RWD Circle</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>

    <style>
      /* 讓整個容器居中並設定最大寬度 */
      #svg-container {
        /* ⚠️ 這裡的寬度設定非常重要，決定了 SVG 實際顯示的大小 */
        width: 90vw; /* 例如，佔視窗寬度的 90% */
        max-width: 450px; /* 但不超過 450px */
        margin: 20px auto; /* 置中 */
        position: relative; /* 必須是 relative，因為 dot1 會基於它定位 */
      }

      /* 確保 dot1 相對於 svg-container 的定位 */
      #dot1 {
        position: absolute;
        top: 0;
        left: 0;
        /* GSAP 會自動設置 transform: translate(...) */
      }

      .img-wrapper {
        position: relative;
        width: 12vw;
        height: 12vw;
        max-width: 150px;
        max-height: 150px;
        /* 確保 GSAP 的 alignOrigin: [0.5, 0.5] 能正確對準中心 */
      }

      /* 點內的紅色圓圈 SVG */
      .dot {
        width: 100%;
        height: 100%;
      }

      /* 圖片容器 */
      .dot-img {
        position: absolute;
        /* 確保 dot-img 的尺寸足夠大，以便圖片定位 */
        width: 100%;
        height: 100%;
        /* 將 dot-img 的定位中心與 .img-wrapper 的中心對齊 */
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      /* 圖片本身：響應式寬度、絕對定位修正 */
      .dot-img img {
        width: 100%; /* 寬度佔滿父容器 (.dot-img) */
        height: auto;

        /* 移除 inline style 的 max-width 限制，讓它跟著縮放 */
        max-width: none !important;

        /* 調整圖片在 dot-img 內的位置 */
        position: absolute;
        left: 0;
        bottom: -8%;
      }
    </style>
  </head>
  <body>
    <div id="svg-container">
      <svg
        viewBox="0 0 300 300"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        style="width: 100%; max-width: 450px; height: auto"
      >
        <path
          d="M150 1.5
       A148.5 148.5 0 1 1 149.999 298.5
       A148.5 148.5 0 1 1 150 1.5"
          stroke="#E15050"
          stroke-width="3"
          fill="none"
          id="path"
        />
      </svg>

      <div id="dot1">
        <div class="img-wrapper">
          <svg class="dot" width="20" height="20">
            <circle cx="10" cy="10" r="10" fill="#E15050" />
          </svg>
          <div class="dot-img">
            <img
              src="img/Profession.png"
              alt="Profession icon"
              style="max-width: 200px"
            />
          </div>
        </div>
      </div>
    </div>

    <script>
      gsap.registerPlugin(MotionPathPlugin);

      // 製作 dot1 沿圓形移動 + 自轉
      let t1 = gsap.to("#dot1", {
        duration: 1,
        ease: "none",
        motionPath: {
          path: "#path",
          align: "#path",
          start: 0,
          end: 0.166666, // 跑六分之一圓
          alignOrigin: [0.5, 0.5], // 確保 wrapper 中心貼著 path
        },
        onUpdate() {
          let p = t1.progress();

          // 旋轉範圍 -60° → 0°
          let rotation = gsap.utils.mapRange(0, 1, -60, 0, p);

          gsap.set("#dot1", { rotation });
        },
      });
    </script>
  </body>
</html>
